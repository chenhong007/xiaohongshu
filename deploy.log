[2025-12-10 14:25:49] >> 🚀 开始完整部署
[2025-12-10 14:25:50] >> 停止现有服务...
[2025-12-10 14:25:50] [INFO] 停止 HTTP 服务...
[2025-12-10 14:26:03] [INFO] 所有服务已停止
[2025-12-10 14:26:03] >> 构建 Docker 镜像...
[2025-12-10 14:26:38] [INFO] 镜像构建完成
[2025-12-10 14:26:38] >> 启动服务...
[2025-12-10 14:27:49] >> 🚀 开始完整部署
[2025-12-10 14:27:49] >> 停止现有服务...
[2025-12-10 14:27:49] [INFO] 停止 HTTP 服务...
[2025-12-10 14:27:51] [INFO] 所有服务已停止
[2025-12-10 14:27:51] >> 构建 Docker 镜像...
[2025-12-10 14:27:53] [INFO] 镜像构建完成
[2025-12-10 14:27:53] >> 启动服务...
[2025-12-10 14:27:54] [INFO] 等待服务启动...
[2025-12-10 14:27:59] >> 检查服务健康状态...
[2025-12-10 14:27:59] [INFO] ✅ 后端服务健康
[2025-12-10 14:27:59] >> 服务状态
[2025-12-10 14:28:00] [INFO] 服务启动完成
[2025-12-10 14:30:41] >> 🔄 开始快速更新
[2025-12-10 14:30:42] >> 📦 备份数据
[2025-12-10 14:30:42] [INFO] 备份数据库...
[2025-12-10 14:30:42] [WARN] 数据库文件可能不存在
[2025-12-10 14:30:42] [INFO] 备份完成: /home/xhs/xiaohongshu/backups/backup_20251210_143042
[2025-12-10 14:30:42] >> 停止现有服务...
[2025-12-10 14:30:42] [INFO] 停止 HTTP 服务...
[2025-12-10 14:30:44] [INFO] 所有服务已停止
[2025-12-10 14:30:44] [INFO] 检查端口占用情况...
[2025-12-10 14:30:44] >> 构建 Docker 镜像...
[2025-12-10 14:31:00] [INFO] 镜像构建完成
[2025-12-10 14:31:00] >> 启动服务...
[2025-12-10 14:31:02] [INFO] 等待服务启动...
[2025-12-10 14:31:07] >> 检查服务健康状态...
[2025-12-10 14:31:07] [INFO] ✅ 后端服务健康
[2025-12-10 14:31:07] >> 服务状态
[2025-12-10 14:31:07] [INFO] 服务启动完成
[2025-12-10 14:31:07] [INFO] ✅ 更新完成
[2025-12-10 14:31:51] >> 🔄 开始快速更新
[2025-12-10 14:31:51] >> 📦 备份数据
[2025-12-10 14:31:51] [INFO] 备份数据库...
[2025-12-10 14:31:51] [WARN] 数据库文件可能不存在
[2025-12-10 14:31:51] [INFO] 备份完成: /home/xhs/xiaohongshu/backups/backup_20251210_143151
[2025-12-10 14:31:51] >> 停止现有服务...
[2025-12-10 14:31:52] [INFO] 停止 HTTP 服务...
[2025-12-10 14:31:54] [INFO] 所有服务已停止
[2025-12-10 14:31:54] [INFO] 检查端口占用情况...
[2025-12-10 14:31:54] >> 构建 Docker 镜像...
[2025-12-10 14:32:12] [INFO] 镜像构建完成
[2025-12-10 14:32:12] >> 启动服务...
[2025-12-10 14:32:14] [INFO] 等待服务启动...
[2025-12-10 14:32:19] >> 检查服务健康状态...
[2025-12-10 14:32:19] [INFO] ✅ 后端服务健康
[2025-12-10 14:32:19] >> 服务状态
[2025-12-10 14:32:19] [INFO] 服务启动完成
[2025-12-10 14:32:19] [INFO] ✅ 更新完成
[2025-12-10 14:36:10] [ERROR] 未知命令: ssl
[2025-12-10 14:41:29] >> 🔐 初始化 SSL 证书
[2025-12-10 14:41:30] >> 停止现有服务...
[2025-12-10 14:41:30] [INFO] 停止 HTTP 服务...
[2025-12-10 14:41:32] [INFO] 所有服务已停止
[2025-12-10 14:41:32] [INFO] 检查系统 Nginx 服务...
[2025-12-10 14:41:32] [INFO] 域名: xhs.topai.ink
[2025-12-10 14:41:32] [INFO] 邮箱: admin@topai.ink
[2025-12-10 14:41:32] [INFO] 创建临时 Nginx 配置...
[2025-12-10 14:41:32] [INFO] 启动临时 Nginx 服务...
[2025-12-10 14:41:37] [INFO] 获取 Let's Encrypt SSL 证书...
[2025-12-10 14:41:59] [INFO] 清理临时资源...
[2025-12-10 14:42:00] [INFO] ✅ SSL 证书获取成功！
[2025-12-10 14:42:00] [INFO] 证书位置: /home/xhs/xiaohongshu/certbot/conf/live/xhs.topai.ink/
[2025-12-10 14:42:13] >> 🚀 开始完整部署
[2025-12-10 14:42:13] >> 停止现有服务...
[2025-12-10 14:42:14] [INFO] 所有服务已停止
[2025-12-10 14:42:14] [INFO] 检查端口占用情况...
[2025-12-10 14:42:14] [INFO] 检查系统 Nginx 服务...
[2025-12-10 14:42:14] >> 构建 Docker 镜像...
[2025-12-10 14:44:15] >> 🚀 开始完整部署
[2025-12-10 14:44:16] >> 停止现有服务...
[2025-12-10 14:44:16] [INFO] 所有服务已停止
[2025-12-10 14:44:16] [INFO] 检查端口占用情况...
[2025-12-10 14:44:16] [INFO] 检查系统 Nginx 服务...
[2025-12-10 14:44:16] >> 构建 Docker 镜像...
[2025-12-10 14:44:16] [INFO] 无缓存构建...
[2025-12-10 14:45:31] [INFO] 镜像构建完成
[2025-12-10 14:45:31] >> 启动服务...
[2025-12-10 14:45:33] [INFO] 等待服务启动...
[2025-12-10 14:45:38] >> 检查服务健康状态...
[2025-12-10 14:45:38] [INFO] ✅ 后端服务健康
[2025-12-10 14:45:38] >> 服务状态
[2025-12-10 14:45:39] [INFO] 服务启动完成
[2025-12-10 14:51:23] >> 🔄 开始快速更新
[2025-12-10 14:51:23] >> 📦 备份数据
[2025-12-10 14:51:23] [INFO] 备份数据库...
[2025-12-10 14:51:23] [WARN] 数据库文件可能不存在
[2025-12-10 14:51:23] [INFO] 备份完成: /home/xhs/xiaohongshu/backups/backup_20251210_145123
[2025-12-10 14:51:23] >> 停止现有服务...
[2025-12-10 14:51:23] [INFO] 停止 HTTP 服务...
[2025-12-10 14:51:27] [INFO] 所有服务已停止
[2025-12-10 14:51:27] [INFO] 检查端口占用情况...
[2025-12-10 14:51:27] [INFO] 检查系统 Nginx 服务...
[2025-12-10 14:51:27] >> 构建 Docker 镜像...
[2025-12-10 14:51:47] [INFO] 镜像构建完成
[2025-12-10 14:51:47] >> 启动服务...
[2025-12-10 14:51:49] [INFO] 等待服务启动...
[2025-12-10 14:51:54] >> 检查服务健康状态...
[2025-12-10 14:51:54] [INFO] ✅ 后端服务健康
[2025-12-10 14:51:54] >> 服务状态
[2025-12-10 14:51:55] [INFO] 服务启动完成
[2025-12-10 14:51:55] [INFO] ✅ 更新完成
[2025-12-10 14:55:16] >> 🔄 开始快速更新
[2025-12-10 14:55:16] >> 📦 备份数据
[2025-12-10 14:55:16] [INFO] 备份数据库...
[2025-12-10 14:55:16] [WARN] 数据库文件可能不存在
[2025-12-10 14:55:16] [INFO] 备份完成: /home/xhs/xiaohongshu/backups/backup_20251210_145516
[2025-12-10 14:55:16] >> 停止现有服务...
[2025-12-10 14:55:17] [INFO] 停止 HTTP 服务...
[2025-12-10 14:55:20] [INFO] 所有服务已停止
[2025-12-10 14:55:20] [INFO] 检查端口占用情况...
[2025-12-10 14:55:20] [INFO] 检查系统 Nginx 服务...
[2025-12-10 14:55:20] >> 构建 Docker 镜像...
[2025-12-10 14:55:37] [INFO] 镜像构建完成
[2025-12-10 14:55:37] >> 启动服务...
[2025-12-10 14:55:39] [INFO] 等待服务启动...
[2025-12-10 14:55:44] >> 检查服务健康状态...
[2025-12-10 14:55:44] [INFO] ✅ 后端服务健康
[2025-12-10 14:55:44] >> 服务状态
[2025-12-10 14:55:45] [INFO] 服务启动完成
[2025-12-10 14:55:45] [INFO] ✅ 更新完成
[2025-12-10 14:58:02] >> 🔄 开始快速更新
[2025-12-10 14:58:02] >> 📦 备份数据
[2025-12-10 14:58:02] [INFO] 备份数据库...
[2025-12-10 14:58:03] [WARN] 数据库文件可能不存在
[2025-12-10 14:58:03] [INFO] 备份完成: /home/xhs/xiaohongshu/backups/backup_20251210_145802
[2025-12-10 14:58:03] >> 停止现有服务...
[2025-12-10 14:58:03] [INFO] 停止 HTTP 服务...
[2025-12-10 14:58:06] [INFO] 所有服务已停止
[2025-12-10 14:58:06] [INFO] 检查端口占用情况...
[2025-12-10 14:58:06] [INFO] 检查系统 Nginx 服务...
[2025-12-10 14:58:07] >> 构建 Docker 镜像...
[2025-12-10 14:58:24] [INFO] 镜像构建完成
[2025-12-10 14:58:24] >> 启动服务...
[2025-12-10 14:58:27] [INFO] 等待服务启动...
[2025-12-10 14:58:29] [ERROR] 未知命令: start
[2025-12-10 14:58:32] >> 检查服务健康状态...
[2025-12-10 14:58:32] [INFO] ✅ 后端服务健康
[2025-12-10 14:58:32] >> 服务状态
[2025-12-10 14:58:32] [INFO] 服务启动完成
[2025-12-10 14:58:32] [INFO] ✅ 更新完成
[2025-12-10 14:58:36] >> 🔄 重启服务
[2025-12-10 14:58:46] >> 服务状态
[2025-12-10 14:58:46] [INFO] 重启完成
[2025-12-10 15:00:28] >> 🚀 开始完整部署
[2025-12-10 15:00:28] >> 停止现有服务...
[2025-12-10 15:00:29] [INFO] 停止 HTTP 服务...
[2025-12-10 15:00:32] [INFO] 所有服务已停止
[2025-12-10 15:00:32] [INFO] 检查端口占用情况...
[2025-12-10 15:00:32] [INFO] 检查系统 Nginx 服务...
[2025-12-10 15:00:32] >> 构建 Docker 镜像...
[2025-12-10 15:00:34] [INFO] 镜像构建完成
[2025-12-10 15:00:34] >> 启动服务...
[2025-12-10 15:00:37] [INFO] 等待服务启动...
[2025-12-10 15:00:42] >> 检查服务健康状态...
[2025-12-10 15:00:42] [INFO] ✅ 后端服务健康
[2025-12-10 15:00:42] >> 服务状态
[2025-12-10 15:00:42] [INFO] 服务启动完成
[2025-12-10 15:00:53] >> 🚀 开始完整部署
[2025-12-10 15:00:53] >> 停止现有服务...
[2025-12-10 15:00:53] [INFO] 停止 HTTP 服务...
[2025-12-10 15:01:01] [INFO] 所有服务已停止
[2025-12-10 15:01:01] [INFO] 检查端口占用情况...
[2025-12-10 15:01:01] [INFO] 检查系统 Nginx 服务...
[2025-12-10 15:01:01] >> 构建 Docker 镜像...
[2025-12-10 15:01:01] [INFO] 无缓存构建...
[2025-12-10 15:02:17] [INFO] 镜像构建完成
[2025-12-10 15:02:17] >> 启动服务...
[2025-12-10 15:02:20] [INFO] 等待服务启动...
[2025-12-10 15:02:25] >> 检查服务健康状态...
[2025-12-10 15:02:25] [INFO] ✅ 后端服务健康
[2025-12-10 15:02:25] >> 服务状态
[2025-12-10 15:02:26] [INFO] 服务启动完成
[2025-12-10 15:03:49] >> 🚀 开始完整部署
[2025-12-10 15:03:49] >> 停止现有服务...
[2025-12-10 15:03:49] [INFO] 所有服务已停止
[2025-12-10 15:03:49] [INFO] 检查端口占用情况...
[2025-12-10 15:03:49] [INFO] 检查系统 Nginx 服务...
[2025-12-10 15:03:50] >> 构建 Docker 镜像...
[2025-12-10 15:03:50] [INFO] 无缓存构建...
[2025-12-10 15:05:06] [INFO] 镜像构建完成
[2025-12-10 15:05:06] >> 启动服务...
[2025-12-10 15:05:08] [INFO] 等待服务启动...
[2025-12-10 15:05:13] >> 检查服务健康状态...
[2025-12-10 15:05:13] [INFO] ✅ 后端服务健康
[2025-12-10 15:05:13] >> 服务状态
[2025-12-10 15:05:14] [INFO] 服务启动完成
[2025-12-10 15:22:18] >> 🚀 开始完整部署
[2025-12-10 15:22:18] >> 停止现有服务...
[2025-12-10 15:22:19] [INFO] 停止 HTTP 服务...
[2025-12-10 15:22:22] [INFO] 所有服务已停止
[2025-12-10 15:22:22] [INFO] 检查端口占用情况...
[2025-12-10 15:22:22] [INFO] 检查系统 Nginx 服务...
[2025-12-10 15:22:22] >> 构建 Docker 镜像...
[2025-12-10 15:22:22] [WARN] ⚠️  检测到未提交的本地更改！
[2025-12-10 15:22:22] [WARN]    构建的镜像可能包含未提交的代码
[2025-12-10 15:22:25] [INFO] Git commit: 0423cf6 (0423cf6807cae98de65bf8a5b31e13035ebe1d94)
[2025-12-10 15:22:25] [INFO] 构建时间: 2025-12-10T15:22:22Z
[2025-12-10 15:22:25] [INFO] 无缓存构建...
[2025-12-10 15:26:07] >> 🚀 开始完整部署
[2025-12-10 15:26:08] >> 停止现有服务...
[2025-12-10 15:26:08] [INFO] 所有服务已停止
[2025-12-10 15:26:08] [INFO] 检查端口占用情况...
[2025-12-10 15:26:08] [INFO] 检查系统 Nginx 服务...
[2025-12-10 15:26:08] >> 构建 Docker 镜像...
[2025-12-10 15:26:08] [WARN] ⚠️  检测到未提交的本地更改！
[2025-12-10 15:26:08] [WARN]    构建的镜像可能包含未提交的代码
[2025-12-10 15:26:11] [INFO] Git commit: 0423cf6 (0423cf6807cae98de65bf8a5b31e13035ebe1d94)
[2025-12-10 15:26:11] [INFO] 构建时间: 2025-12-10T15:26:08Z
[2025-12-10 15:26:11] [INFO] 无缓存构建...
[2025-12-10 15:27:26] [INFO] 镜像构建完成 (commit: 0423cf6)
[2025-12-10 15:27:26] >> 启动服务...
[2025-12-10 15:27:29] [INFO] 等待服务启动...
[2025-12-10 15:27:34] >> 检查服务健康状态...
[2025-12-10 15:27:34] [INFO] ✅ 后端服务健康
[2025-12-10 15:27:34] >> 🔍 验证镜像代码版本...
[2025-12-10 15:27:34] [INFO] 当前 Git commit: 0423cf6 (0423cf6807cae98de65bf8a5b31e13035ebe1d94)
[2025-12-10 15:27:34] [INFO] ✅ 镜像版本匹配: 0423cf6
[2025-12-10 15:27:34] [INFO]    构建时间: 2025-12-10T15:26:08Z
[2025-12-10 15:27:34] >> 服务状态
[2025-12-10 15:27:35] [INFO] 服务启动完成
[2025-12-10 15:33:11] >> 🚀 开始完整部署
[2025-12-10 15:33:11] >> 停止现有服务...
[2025-12-10 15:33:12] [INFO] 停止 HTTP 服务...
[2025-12-10 15:33:14] [INFO] 所有服务已停止
[2025-12-10 15:33:14] [INFO] 检查端口占用情况...
[2025-12-10 15:33:14] [INFO] 检查系统 Nginx 服务...
[2025-12-10 15:33:15] >> 构建 Docker 镜像...
[2025-12-10 15:33:15] [WARN] ⚠️  检测到未提交的本地更改！
[2025-12-10 15:33:15] [WARN]    构建的镜像可能包含未提交的代码
[2025-12-10 15:33:15] [ERROR] 已取消构建，请先提交代码
